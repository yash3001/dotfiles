'use strict';Registry.require(["promise","helper","asker"],()=>{const e=Registry.get("promise"),m=Registry.get("helper"),n=Registry.get("asker");let c=!1,f=null,l=null;const p=a=>{rea.permissions.supported&&(rea.permissions.onAdded.addListener(b=>{a({added:b})}),rea.permissions.onRemoved.addListener(b=>{a({removed:b})}))},h={permDownloads:"downloads",get:function(){const a=e();f={};l={};c=a.promise();rea.permissions.supported?rea.permissions.getAll(b=>{b.permissions&&m.each(b.permissions,(d,g)=>{f[d]=
!0});b.origins&&m.each(b.origins,(d,g)=>{l[d]=!0});c=null;a.resolve()}):a.resolve();return a.promise()},has:function(a){return(c?c:e.Pledge()).then(()=>rea.permissions.supported?f?!!f[a]||!!l[a]:(p(()=>{(c?c:e.Pledge()).then(h.get)}),h.get().then(()=>h.has(a))):!0)},hasOrigin:function(a){Array.isArray(a)||(a=[a]);return(c?c:e.Pledge()).then(()=>{const b=e();rea.permissions.supported?rea.permissions.contains({origins:a},d=>{b.resolve(d)}):b.resolve(!0);return b.promise()})},ask:function(a,b,d){Array.isArray(a)||
(a=[a]);const g=e();rea.permissions.supported?n.askForPermission({permissions:a},b,d).done(k=>{k.granted&&(f||(f={}),f[a]=!0);g.resolve(k.granted)}):g.resolve(!1);return g.promise()},askOrigin:function(a,b,d){Array.isArray(a)||(a=[a]);const g=e();rea.permissions.supported?n.askForPermission({origins:a},b,d).done(k=>{g.resolve(k.granted)}):g.resolve(!1);return g.promise()},remove:function(a){return(c?c:e.Pledge()).then(()=>{const b=e();rea.permissions.supported?(c=b.promise(),rea.permissions.remove({permissions:[a]},
d=>{c=null;f&&(f[a]=!1);b.resolve(d)})):b.resolve(!0);return b.promise()})},addListener:p};Registry.register("permission","e1582c36",h)});
