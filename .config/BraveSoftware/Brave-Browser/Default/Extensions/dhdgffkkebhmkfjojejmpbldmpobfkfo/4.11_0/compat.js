'use strict';Registry.require(["helper"],()=>{const l=Registry.get("helper"),k={mkCompat:function(a,c,b,d){if(c){if(c.options.compat_wrappedjsobject||d)a=k.unWrappedJsObjectify(a);if(c.options.compat_metadata||d)a=k.unMetaDataify(a);if(c.options.compat_foreach||d)a=k.unEachify(a);if(c.options.compat_arrayleft||d)a=k.unArrayOnLeftSideify(a);c.options.compat_forvarin&&(a=k.fixForVarXStatements(a))}b||(a=a.replace(/(['"]{1,1})use strict(['"]{1,1})/g,"$1use\u00a0strict$2"));return a},findPrototypes:function(a){if(a.includes(".toSource("))return!0;
const c="indexOf lastIndexOf filter forEach every map some slice".split(" ");for(const b in c)if(a.includes("Array."+c[b]+"("))return!0},fixForVarXStatements:function(a){a=a.replace(/for[ \t.]*\([ \t.]*var/gi,"for (var");a=a.split("for (");for(let e=1;e<a.length;e++){var c=a[e];const f=c.indexOf(")");if(-1!=f){var b=c.substr(0,f);if(-1!=b.search(/[ \r\n]*in[ \r\n]/)){var d=b.match(/^[ \r\n]*(?:var[ \r\n\t]*)*(.*?)[ \r\n]* in [ \r\n]*(.*?)$/);null==d||3>d.length||(b=d[1],d=d[2],!b||!d||f>c.length||
c.search(/\)[\n\r\t ]*\{/)!=f||(c="",c+="{     if (!"+d+".hasOwnProperty("+b+")) continue;",a[e]=a[e].replace("{",c)))}}}return a.join("for (")},unArrayOnLeftSideify:function(a){const c=a.split("\n");c.forEach((b,d)=>{const e=b.replace(/[\t ]/g,"");var f=e.indexOf("]=");const g=e.indexOf("]=="),h=e.indexOf("[");-1!=h&&""!=e.substr(0,h)&&(f=-1);if(-1!=f&&f!=g){let m="";f=b.indexOf("=");b=b.substr(f+1,b.length-f-1);const n="__narf"+d.toString();m+="var "+n+" = "+b+";\n";l.getStringBetweenTags(e,"[",
"]=").split(",").forEach((p,q)=>{""!=p.trim()&&(m+=p+" = "+n+"["+q+"];\n")});c[d]=m}});return c.join("\n")},unEachify:function(a){a=a.replace(/for each[ \t]*\(/gi,"for each(");a=a.split("for each");for(let e=1;e<a.length;e++){var c=a[e];if("("!=c.substr(0,1)){a[e]=" each"+a[e];continue}c=l.getStringBetweenTags(c,"(",")");var b=c.split(" ");let f=null;var d=null;let g=null;for(const h in b)""!=b[h]&&"var"!=b[h]&&(f?d?g||(g=b[h]):d=b[h]:f=b[h]);f&&g?(b="var __kk in "+g,d="",d+="{\n    if (!"+g+".hasOwnProperty(__kk)) continue;",
d+=" \n    var "+f+" = "+g+"[__kk];",a[e]=a[e].replace(c,b).replace("{",d)):a[e]=" each"+a[e]}return a.join("for")},unMetaDataify:function(a){let c=a;for(var b=c.indexOf("<><![CDATA[");-1!=b;){const e=c.substr(0,b),f=e.lastIndexOf("\n");var d="";-1!=f&&(d=e.substr(f,e.length-f));c=c.substr(b,c.length-b);b=d.indexOf("/*");d=d.indexOf("//");-1==b&&-1==d&&(b=d=l.getStringBetweenTags(c,"<><![CDATA[","]]\x3e</>"),b=b.replace(/\\/g,"\\\\"),b=b.replace(/"/g,'\\"').replace(/\n/g,'\\n" + \n"'),b=b.replace(/^\n/g,
"").replace(/\n$/g,""),b=b.replace(/\r/g,""),a=a.replace("<><![CDATA["+d+"]]\x3e</>",'(new CDATA("'+b+'"))'));c=c.substr(1,c.length-1);b=c.indexOf("<><![CDATA[")}return a},unWrappedJsObjectify:function(a){a=a.split("\n");for(let c=0;c<a.length;c++){const b=a[c].indexOf(".wrappedJSObject");if(-1==b)continue;const d=a[c].indexOf("//");-1!=d&&d<b||(a[c]=a[c].replace(/\.wrappedJSObject/g,""))}return a.join("\n")}};Registry.register("compat","e1582c36",()=>k)});
