'use strict';(function(g){"object"==typeof exports&&"object"==typeof module?g(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],g):g(CodeMirror)})(function(g){function r(a){a.state.markedSelection&&a.operation(function(){w(a)})}function t(a){a.state.markedSelection&&a.state.markedSelection.length&&a.operation(function(){m(a)})}function k(a,b,c,d){if(0!=h(b,c))for(var e=a.state.markedSelection,f=a.state.markedSelectionStyle,l=b.line;;){var n=l==
b.line?b:u(l,0);l+=p;var v=l>=c.line,x=v?c:u(l,0);n=a.markText(n,x,{className:f});null==d?e.push(n):e.splice(d++,0,n);if(v)break}}function m(a){a=a.state.markedSelection;for(var b=0;b<a.length;++b)a[b].clear();a.length=0}function q(a){m(a);for(var b=a.listSelections(),c=0;c<b.length;c++)k(a,b[c].from(),b[c].to())}function w(a){if(!a.somethingSelected())return m(a);if(1<a.listSelections().length)return q(a);var b=a.getCursor("start"),c=a.getCursor("end"),d=a.state.markedSelection;if(!d.length)return k(a,
b,c);var e=d[0].find(),f=d[d.length-1].find();if(!e||!f||c.line-b.line<=p||0<=h(b,f.to)||0>=h(c,e.from))return q(a);for(;0<h(b,e.from);)d.shift().clear(),e=d[0].find();0>h(b,e.from)&&(e.to.line-b.line<p?(d.shift().clear(),k(a,b,e.to,0)):k(a,b,e.from,0));for(;0>h(c,f.to);)d.pop().clear(),f=d[d.length-1].find();0<h(c,f.to)&&(c.line-f.from.line<p?(d.pop().clear(),k(a,f.from,c)):k(a,f.to,c))}g.defineOption("styleSelectedText",!1,function(a,b,c){c=c&&c!=g.Init;b&&!c?(a.state.markedSelection=[],a.state.markedSelectionStyle=
"string"==typeof b?b:"CodeMirror-selectedtext",q(a),a.on("cursorActivity",r),a.on("change",t)):!b&&c&&(a.off("cursorActivity",r),a.off("change",t),m(a),a.state.markedSelection=a.state.markedSelectionStyle=null)});var p=8,u=g.Pos,h=g.cmpPos});
